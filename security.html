<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jun 6, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Server architecture overview</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20120606" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                Java JMS Stock Brokers
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2012-06-06</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0-SNAPSHOT</span>
                      </div>
            <div class="xright">        
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                          <h5>Project Specification</h5>
                  <ul>
                  <li class="none">
                          <a href="requirements.html" title="Requirements">Requirements</a>
            </li>
                  <li class="none">
                          <a href="use-cases.html" title="Use Cases">Use Cases</a>
            </li>
                                                                                <li class="expanded">
                          <a href="architecture.html" title="Architecture">Architecture</a>
                    <ul>
                      <li class="none">
                          <a href="server-architecture.html" title="Stock Indices Server">Stock Indices Server</a>
            </li>
                      <li class="none">
                          <a href="client-architecture.html" title="Spring MVC Client">Spring MVC Client</a>
            </li>
              </ul>
        </li>
                  <li class="none">
            <strong>Security</strong>
          </li>
          </ul>
                       <h5>Modules</h5>
                  <ul>
                  <li class="none">
                          <a href="server/index.html" title="Stock Indices Server">Stock Indices Server</a>
            </li>
                  <li class="none">
                          <a href="client/index.html" title="Spring MVC Client">Spring MVC Client</a>
            </li>
          </ul>
                       <h5>Team Meetings</h5>
                  <ul>
                  <li class="none">
                          <a href="https://github.com/gosia-wielgus/jms-brokers/downloads" class="externalLink" title="Minutes">Minutes</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>System security assessment<a name="System_security_assessment"></a></h2><p>Attacks may come from:</p><ul><li>Internet</li><li>Client's network</li><li>Internet</li><li>Subverted client machine</li><li>Subverted server machine</li></ul><p>They may center on following components:</p><ul><li>our web application logic</li><li>ActiveMQ services</li><li>Web Application Container</li></ul><p>Attacks can cause:</p><ul><li>Disruption of service</li><li>Be an attack vector on web application clients, server machines</li></ul><p>Effective reaction to attack threats should depend on it's likelihood and possible damage</p></div><div class="section"><h2>Installation recommendations<a name="Installation_recommendations"></a></h2><p>General remarks:</p><ul><li>Attacks on central server and web application server operating systems should be mitigated by not storing any sensitive data on server machines.</li><li>Disruption of service by outsiders should be mitigated by only allowing CA-trusted clients to communicate with the server and possibly by firewall rules.</li><li>Operation of web application should be confined to internal networks, as outside access increases the attack surface.</li></ul><p>Tomcat hardening:</p><ul><li>Confine listen address only to interfaces you want:<div><pre>    &lt;Connector address=&quot;127.0.0.1&quot; ... /&gt;</pre></div></li><li>Disable unneeded services:<div><pre>    &lt;!--&lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt;--&gt;</pre></div></li><li>Disable shutdown port<div><pre>&lt;Server port=&quot;-1&quot; ...&gt;</pre></div></li></ul></div><div class="section"><h2>Setting up a proxy server<a name="Setting_up_a_proxy_server"></a></h2><p>To use the web application with apache2 proxy server:</p><ul><li>install apache2 with mod_proxy, mod_proxy_http and preferably mod_security and mod_evasive</li><li>update apache configuration, add:<div><pre>ProxyPass /client-1.0-SNAPSHOT http://localhost:8080/client-1.0-SNAPSHOT
ProxyPassReverse /client-1.0-SNAPSHOT http://localhost:8080/client-1.0-SNAPSHOT</pre></div></li><li>update tomcat configuration, add in connector proxy settings:<div><pre>    &lt;Connector address=&quot;127.0.0.1&quot; port=&quot;8080&quot; proxyName=&quot;localhost&quot; proxyPort=&quot;80 ... /&gt;</pre></div></li><li>Possibly add mod_security recommended config options</li><li>Possibly add mod_evasive configuration to prevent brute force login attacks:<div><pre>&lt;IfModule mod_evasive20.c&gt;
DOSHashTableSize    3097
DOSPageCount        2
DOSSiteCount        50
DOSPageInterval     1
DOSSiteInterval     1
DOSBlockingPeriod   60
DOSEmailNotify exapmle@example.com
&lt;/IfModule&gt;</pre></div></li></ul></div><div class="section"><h2>Security improvements<a name="Security_improvements"></a></h2><p>The following actions were taken with respect to code security:</p><ul><li>Fixed SQL injection exploit (exploitable via ActiveMQ)</li><li>Installed mutual authentication for ActiveMQ brokers</li><li>Validated SpringSecurity authentication</li></ul></div><div class="section"><h2>Security scan results<a name="Security_scan_results"></a></h2><div class="section"><h3>Nessus <a name="Nessus"></a></h3><p>Nessus identified mostly self-signed certificates and information disclosure. The more severe instances of information disclosure of apache-httpd were present only on 127.0.0.1 interface, and were not exploitable from outside. </p><ul><li><a class="externalLink" href="https://github.com/downloads/gosia-wielgus/jms-brokers/nessus-internal.pdf">https://github.com/downloads/gosia-wielgus/jms-brokers/nessus-internal.pdf</a> - internal network scan</li><li><a class="externalLink" href="https://github.com/downloads/gosia-wielgus/jms-brokers/nessus-web.pdf">https://github.com/downloads/gosia-wielgus/jms-brokers/nessus-web.pdf</a> - web application scan</li></ul></div><div class="section"><h3>Nikto security scanner<a name="Nikto_security_scanner"></a></h3><p>Nikto could identify unneccesarily allowed HTTP methods, but these are not actually in use. There are also warnings about disclosed server information.</p><div><pre>- Nikto v2.1.4

+ Target IP:          127.0.0.1
+ Target Hostname:    localhost
+ Target Port:        8080
+ Start Time:         2012-05-17 12:58:02

+ Server: Apache-Coyote/1.1
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ OSVDB-39272: /favicon.ico file identifies this server as: Apache Tomcat
+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS 
+ OSVDB-397: HTTP method ('Allow' Header): 'PUT' method could allow clients to save files on the web server.
+ OSVDB-5646: HTTP method ('Allow' Header): 'DELETE' may allow clients to remove files on the web server.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ /examples/servlets/index.html: Apache Tomcat default JSP pages present.
+ OSVDB-3720: /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users.
+ 6448 items checked: 0 error(s) and 7 item(s) reported on remote host                                                                                                                          
+ End Time:           2012-05-17 12:58:19 (17 seconds)                                                                                      
                                                    
+ 1 host(s) tested</pre></div></div><div class="section"><h3>nmap<a name="nmap"></a></h3><p>Nmap accused tomcat of being an open proxy server, which is not the case.</p><div><pre>Starting Nmap 5.21 ( http://nmap.org ) at 2012-05-16 13:00 CEST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00016s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
53/tcp   open  domain  dnsmasq 2.59
80/tcp   open  http    Apache httpd 2.2.22 ((Ubuntu))
|_html-title: Index of /
631/tcp  open  ipp     CUPS 1.5
8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
|_html-title: Apache Tomcat/7.0.27
|_http-open-proxy: Proxy might be redirecting requests</pre></div></div><div class="section"><h3>OpenVAS<a name="OpenVAS"></a></h3><p>OpenVAS complained mainly about version identyfying information</p><div><pre>
Reported by NVT &quot;Apache Tomcat servlet/JSP container default files &quot; (1.3.6.1.4.1.25623.1.0.12085):



Default files, such as documentation, default Servlets and JSPs were found on 
the Apache Tomcat servlet/JSP container.  

Solution: Remove default files, example JSPs and Servlets from the Tomcat 
Servlet/JSP container. 

These files should be removed as they may help an attacker to guess the
exact version of Apache Tomcat which is running on this host and may provide 
other useful information.

The following default files were found :
/examples/servlets/index.html
/examples/jsp/snp/snoop.jsp
/examples/jsp/index.html

Risk factor : Low
Reported by NVT &quot;Apache Tomcat Version Detection&quot; (1.3.6.1.4.1.25623.1.0.800371):

Apache Tomcat version 7.0.27 was detected on the host

====================================================================
Reported by NVT &quot;Apache Web ServerVersion Detection&quot; (1.3.6.1.4.1.25623.1.0.900498):

Apache Web Server version 2.2.22 was detected on the host

====================================================================
Reported by NVT &quot;OS fingerprinting&quot; (1.3.6.1.4.1.25623.1.0.102002):

ICMP based OS fingerprint results: 

Linux Kernel 2.6.11 (accuracy 92%)
Linux Kernel 2.6.10 (accuracy 92%)
Linux Kernel 2.6.9 (accuracy 92%)
Linux Kernel 2.6.8 (accuracy 92%)
Linux Kernel 2.6.7 (accuracy 92%)
Linux Kernel 2.6.6 (accuracy 92%)
Linux Kernel 2.6.5 (accuracy 92%)
Linux Kernel 2.6.4 (accuracy 92%)
Linux Kernel 2.6.3 (accuracy 92%)
Linux Kernel 2.6.2 (accuracy 92%)
Linux Kernel 2.6.1 (accuracy 92%)
Linux Kernel 2.6.0 (accuracy 92%)
Linux Kernel 2.4.30 (accuracy 92%)
Linux Kernel 2.4.29 (accuracy 92%)
Linux Kernel 2.4.28 (accuracy 92%)
Linux Kernel 2.4.27 (accuracy 92%)
Linux Kernel 2.4.26 (accuracy 92%)
Linux Kernel 2.4.25 (accuracy 92%)
Linux Kernel 2.4.24 (accuracy 92%)
Linux Kernel 2.4.23 (accuracy 92%)
Linux Kernel 2.4.22 (accuracy 92%)
Linux Kernel 2.4.21 (accuracy 92%)
Linux Kernel 2.4.20 (accuracy 92%)
Linux Kernel 2.4.19 (accuracy 92%)
Linux Kernel 2.0.36 (accuracy 92%)
Linux Kernel 2.0.34 (accuracy 92%)
Linux Kernel 2.0.30 (accuracy 92%)


</pre></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2012.
          All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
